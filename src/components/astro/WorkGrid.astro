---
import type { Work } from "../../types";

interface Props {
  works: Work[];
  /** カードサイズ: 大（lg）/小（sm）。未指定ならトップページはlg、それ以外はsm */
  size?: "lg" | "sm";
}

const { works, size } = Astro.props;

const resolvedSize = size ?? (Astro.url.pathname === "/" ? "lg" : "sm");

const sectionBaseClass = "flex flex-col";
const sectionClass =
  resolvedSize === "lg"
    ? `${sectionBaseClass} gap-section-gap py-section-gap`
    : `${sectionBaseClass} gap-div-gap py-div-gap`;

const gridClass =
  resolvedSize === "lg"
    ? "grid gap-item-gap grid-cols-3 max-[800px]:grid-cols-1"
    : "grid gap-[calc(var(--item-gap)/2)] grid-cols-4 max-[1000px]:grid-cols-3 max-[800px]:grid-cols-2";

const titleBaseClass = "";
const titleClass =
  resolvedSize === "sm"
    ? `${titleBaseClass} text-sm`
    : `${titleBaseClass} text-base`;

const categoryBaseClass = "opacity-50";
const categoryClass =
  resolvedSize === "sm"
    ? `${categoryBaseClass} text-xs`
    : `${categoryBaseClass} text-xs`;
---

<section id="work" class={sectionClass}>
  <div
    class="flex flex-col gap-div-gap w-[85vw] sm:w-[80vw] max-w-[1400px] mx-auto"
  >
    <h2 class="sr-only">Work</h2>
    <div class={gridClass}>
      {
        works.map((work, index) => (
          <a
            href={`/work/${work.slug}/`}
            data-reveal
            style={`--reveal-delay: ${index * 60}ms;`}
            class="group block"
          >
            <div class="flex flex-col gap-3">
              <div class="aspect-square overflow-hidden">
                <div
                  class="w-full h-full bg-center bg-cover transition-transform duration-500 ease-out will-change-transform group-hover:scale-105"
                  style={`background-image: url('${work.thumbnail}');`}
                />
              </div>
              <div class="flex flex-col gap-1">
                <h3 class={titleClass} set:html={work.title} />
                <p class={categoryClass}>{work.category}</p>
              </div>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</section>
